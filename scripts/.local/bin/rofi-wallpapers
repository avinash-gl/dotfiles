#!/usr/bin/env bash

WALL_DIR="$HOME/wallpapers"
THEME_FILE="$HOME/.config/rofi/themes/wallpaper.rasi"

# Generate list with image previews
wallpaper=$(find -L "$WALL_DIR" -maxdepth 1 -type f \( -iname "*.jpg" -o -iname "*.png" -o -iname "*.jpeg" \) \
    -printf "%f\n" | shuf | while read -r wp; do
        printf "%s\0icon\x1f%s/%s\n" "$wp" "$WALL_DIR" "$wp"
    done | rofi -dmenu \
        -theme "$THEME_FILE" \
         )

[ -z "$wallpaper" ] && exit

wal -i "$WALL_DIR/$wallpaper"
